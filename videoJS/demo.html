<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>

		<!-- UnitTest -->
		<link rel="stylesheet" href="./unitTest/qunit-1.12.0.css">


		<!-- The stylesheets : http://bootswatch.com/slate/ -->
		<link rel="stylesheet" href="css/bootstrap.css" />
		<link rel="stylesheet" href="css/aVideo.css" />

		<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
		<script src="js/aVideo.js"></script>

		<script type="text/javascript">

		// Video
		// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html

		// track
		// http://lab.cliel.com/673

		// 서버
		// http://blog.naver.com/pipecivil?Redirect=Log&logNo=50182457570


			var options = {
				controls: true,
				// autoplay: true,

				// none, metadata, auto
				// "metadata"로 설정 하면 poster 설정하지 않아도 첫화면 보여짐
				preload: "metadata",
				//src:"videoJS/sample.mp4",

				loop: false,
				poster:"poster.png",
				width:640,
				height:300
			};

			var player = AVideo.create('#html5player', options, function(){
				console.log(this.currentTime(), "/", this.duration());
				this.currentTime(25);
			});

			var isTest;
			isTest = true;

			$(function(){

				// 속성 설정 테스트
				//player.src('videoJS/sample.mp4');

				/*
				// 이벤트 청취 테스트
				player.one('ready', onLoadData);

				function onLoadData(){
					console.log('# loadedmetadata 이벤트 리스너 성공!!');
					//player.off('ready', onLoadData);
					player.src('videoJS/sample.mp4');
					player.currentTime(0);
				}
				//*/

				//----------------------
				// 기능 테스트 버튼
				//----------------------

				$("#playButton").on('click', function (){
					player.play();
				});

				$("#stopButton").on('click', function (){
					player.stop();
				});

				$("#pauseButton").on('click', function (){
					player.pause();
				});

				$("#disposeButton").on('click', function (){
					player.dispose();
				});

				$("#togglePlayButton").on('click', function (){
					player.togglePlay();
				});

				//----------------------
				// 기타 설정
				//----------------------

				// autoplay
				$("#autoplayCB").on('change', function (){
					var val = $(this).is(':checked');
					player.set('autoplay', val);
				});

				// url
				$("#setUrlButton").on('click', function (){
					var val = $('#urlBox').val();
					player.set('src', val);
				});

				//----------------------
				// 모니터링
				//----------------------

				player.on('durationchange', function(){
					var value = player.duration();
					$("#duration").text(value);

					var remain = "-" + player.remainTime();
					$("#remainTime").text(remain);
				});

				player.on('timeupdate', function(){
					var value = player.currentTime();
					$("#currentTime").text(value);

					var remain = "-" + player.remainTime();
					$("#remainTime").text(remain);
				});

				player.on('ended', function(){
					var remain = "- END -";
					$("#remainTime").text(remain);
				});

				player.on('volumechange', function(){
					var value = this.volume();
					$("#volume").text(value);

					var muted = this.muted();
					$("#muted").text(muted);
				});

				player.on('error', function(e){
					var readyState = player.readyState();
					var networkState = player.networkState();

					$("#error").html(
						'[ERROR]<br> ' +
						'readyState : ' + readyState + ' <br> ' +
						'networkState : ' + networkState
					);
				});
			});

		</script>
	</head>

	<body>


		<div style="width: 680px; height: 100%; position:relative; border: 1px dotted #FF0000;padding: 20px">

			<video id="html5player">

				<source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4' />
				<!--<source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm' />
				<source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg' />
				<track kind="captions" src="demo.captions.vtt" srclang="en" label="English"></track>-->
				<track kind="subtitles" src="demo.captions.vtt" srclang="en" label="English"></track>


				<!--<track kind="subtitles" src="track.srt" srclang="ko" label="korean" />-->
			</video>


			<br>
		    <input type="button" value="play" class="btn btn-default" id="playButton">
		    <input type="button" value="stop" class="btn btn-default" id="stopButton">
		    <input type="button" value="pause" class="btn btn-default" id="pauseButton">
		    <input type="button" value="togglePlay" class="btn btn-default" id="togglePlayButton">
		    <input type="button" value="dispose" class="btn btn-default" id="disposeButton">

			<br><br><br>

			<!--url-->
			<div class="form-group">
				<label class="control-label">Movie URL : </label>
				<div class="input-group">

					<input type="text" class="form-control" id="urlBox"
						value="http://video-js.zencoder.com/oceans-clip.ogv">
					<span class="input-group-btn">
						<button class="btn btn-default" type="button" id="setUrlButton">SET</button>
					</span>

				</div>
			</div>

			<!--autoplay-->
			<div class="checkbox">
				<label><input type="checkbox" id="autoplayCB">autoplay</label>
			</div>

			<ul class="breadcrumb">
				<li class="active">
					<span id="currentTime">0:00</span> /
					<span id="duration">0:00</span> (
					<span id="remainTime">-0:00</span> )
				</li>
			</ul>
			<ul class="breadcrumb">
				<li class="active">
					Volume : <span id="volume">0:00</span> (mute : <span id="muted">-0:00</span> )
				</li>
			</ul>

			<!--Error-->
			<div id="error" class="jumbotron"></div>









			<!-- UnitTest -->
			<div id="qunit"></div>
			<div id="qunit-fixture"></div>

			<script src="./unitTest/qunit-1.12.0.js"></script>
			<script src="./unitTest/test.js"></script>

		</div>
	</body>
</html>