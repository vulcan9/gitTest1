var http = require('http');

var app = http.createServer(handler)
, io = require('socket.io').listen(app)
, fs = require('fs');

app.listen(80);


function handler(req, res)
{
	console.log('server ok');
	

	fs.readFile(
		__dirname + '/index.html',
		function (err, data)
		{
			if(err){
				res.writeHead(500);
				return res.end('Error loading index.html');
			}
			
			res.writeHead(200, {'Content-Type':'text/html'});
			//res.end("<h1>Hello node.js---<h1>");
			res.end(data);
		}
	);
}

io.sockets.on(
'connection',
function(socket)
{
	socket.emit(
			'news',
			{
				hello:'world'
			}
		);
	
	socket.on(
			'my other event',
			function (data)
			{
				console.log(data);
			}
		);
}
);




